@if (movie(); as m) {
  <div class="details-page">
    <!-- Backdrop using pipe -->
    @if (m.backdropPath) {
      <img appImageLoader [src]="m.backdropPath | tmdbImage:'w1280'" alt="" class="backdrop-img" />
    }

    <div class="content">
      <!-- Poster using pipe -->
      <img
        appImageLoader
        [src]="m.posterPath | tmdbImage:'w500'"
        [alt]="m.title"
        class="poster"
        [fallback]="'assets/movie-placeholder.png'"
      />

      <div class="info">
        <h1>{{ m.title }} <span class="year">({{ year() }})</span></h1>
        
        @if (m.tagline) {
          <p class="tagline">"{{ m.tagline }}"</p>
        }
        
        <div class="meta">
          <span class="rating">â­ {{ rating() }}</span>
          @if (m.voteCount) {
            <span class="votes">({{ m.voteCount | number }} votes)</span>
          }
          @if (m.runtime) {
            <span class="runtime">ğŸ• {{ m.runtime | formatRuntime }}</span>
          }
          @if (m.status && m.status !== 'Released') {
            <span class="status">ğŸ“ {{ m.status }}</span>
          }
        </div>

        <p class="overview">{{ m.synopsis }}</p>

        <div class="actions">
          @if (trailerKey()) {
            <button class="btn-trailer" (click)="playTrailer()">â–¶ Play Trailer</button>
          }
          <button
            class="btn-watchlist"
            [class.in-watchlist]="isInWatchlist()"
            (click)="toggleWatchlist()"
          >
            {{ isInWatchlist() ? 'âœ“ In Watchlist' : '+ Add to Watchlist' }}
          </button>
          <button class="btn-back" (click)="goBack()">â† Back</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Trailer Modal (outside details-page for proper fixed positioning) -->
  @if (showTrailer()) {
    <div class="trailer-modal" (click)="closeTrailer()">
      <div class="trailer-content" (click)="$event.stopPropagation()">
        <button class="close-btn" (click)="closeTrailer()">âœ•</button>
        <iframe
          [src]="'https://www.youtube.com/embed/' + trailerKey() + '?autoplay=1' | safeUrl"
          allowfullscreen
        ></iframe>
      </div>
    </div>
  }
} @else {
  <div class="not-found">Movie not found</div>
}
